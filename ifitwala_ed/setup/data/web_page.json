[
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": "# Helper to build resized image URLs\ndef simple_resized_url(original_url, doctype_folder, size_label):\n    if not original_url:\n        return None\n    filename = original_url.split(\"/\")[-1]\n    base_name = \".\".join(filename.split(\".\")[:-1])\n    resized_filename = f\"{size_label}_{base_name}.jpg\"\n    return f\"/files/gallery_resized/{doctype_folder}/{resized_filename}\"\n\n# Get root-level school node (top of nested set)\ncontext.school = frappe.get_all(\n    \"School\",\n    filters={\"is_group\": 1},\n    fields=[\"name\"],\n    order_by=\"lft asc\",\n    limit_page_length=1\n)[0]\ncontext.school = frappe.get_doc(\"School\", context.school.name)\n\n# Process gallery images for hero carousel\nfor img in context.school.gallery_image:\n\tif img.school_image:\n\t\timg.resized_school_image_small = simple_resized_url(img.school_image, \"school\", \"small\")\n\t\timg.resized_school_image_medium = simple_resized_url(img.school_image, \"school\", \"medium\")\n\t\timg.resized_school_image_large = simple_resized_url(img.school_image, \"school\", \"large\")\n",
  "css": "/* ────────────────────────────────────────────── */\n/* HERO SECTION: Main slide and image layering   */\n/* ────────────────────────────────────────────── */\n.hero-slide {\n  position: relative;\n  height: 70vh;\n  overflow: hidden;\n}\n\n.hero-blur-bg {\n  position: absolute;\n  top: 0; left: 0;\n  width: 100%; height: 100%;\n  background-size: cover;\n  background-position: center;\n  filter: blur(12px) brightness(0.6);\n  z-index: 1;\n}\n\n.hero-img-wrapper {\n  position: absolute;\n  top: 0; left: 0;\n  width: 100%; height: 100%;\n  z-index: 2;\n  overflow: hidden;\n}\n\n.hero-img {\n  position: absolute;\n  top: 0; left: 0;\n  width: 100%; height: 100%;\n  object-fit: cover;\n  transition: opacity 1s ease-in-out;\n}\n\n.hero-img-blur {\n  filter: blur(20px);\n  transform: scale(1.05);\n  z-index: 1;\n}\n\n.hero-img-full {\n  opacity: 0;\n  z-index: 2;\n}\n\n.hero-img-full.loaded {\n  opacity: 1;\n}\n\n/* ────────────────────────────────────────────── */\n/* CAPTION OVER IMAGES                           */\n/* ────────────────────────────────────────────── */\n.school-caption {\n  position: absolute;\n  bottom: 1rem;\n  right: 1rem;\n  background: rgba(0, 0, 0, 0.5);\n  color: white;\n  font-size: 0.9rem;\n  padding: 0.4rem 0.8rem;\n  border-radius: 4px;\n  z-index: 3;\n  max-width: 50%;\n  font-family: \"Inter\", sans-serif;\n}\n\n/* ────────────────────────────────────────────── */\n/* TAGLINE BELOW CAROUSEL                        */\n/* ────────────────────────────────────────────── */\n.school-tagline {\n  text-align: center;\n  margin-top: 2rem;\n  margin-bottom: 2rem;\n  font-size: 1.4rem;\n  font-style: italic;\n  font-family: \"Georgia\", \"Times New Roman\", serif;\n  color: #444;\n}\n",
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 1,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 1,
  "javascript": "document.addEventListener(\"DOMContentLoaded\", function () {\n  const carousel = document.querySelector(\"#schoolHeroCarousel\");\n\n  if (carousel) {\n    new bootstrap.Carousel(carousel, {\n      interval: 5000,\n      ride: 'carousel',\n      pause: false\n    });\n  }\n\n  // Fallback fade-in class for smart loaded images\n  document.querySelectorAll(\".hero-img-full\").forEach((img) => {\n    img.addEventListener(\"load\", () => {\n      img.classList.add(\"loaded\");\n    });\n  });\n\n  // Lazy image fade-in fallback\n  document.querySelectorAll(\"img[loading='lazy']\").forEach((img) => {\n    img.addEventListener(\"load\", () => {\n      img.classList.add(\"loaded\");\n    });\n  });\n});",
  "main_section": null,
  "main_section_html": "<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js\" defer></script>\n\n\n<!-- Shared CSS + JS -->\n<link rel=\"stylesheet\" href=\"/assets/ifitwala_ed/website/website.css\" onerror=\"console.warn('Could not load website.css')\">\n<script src=\"/assets/ifitwala_ed/website/website.js\" defer></script>\n\n<!-- Smart image fallback system -->\n<script src=\"/assets/ifitwala_ed/website/image_fallback.js\" defer></script>\n{% import \"ifitwala_ed/templates/includes/smart_image_macro.html\" as img_macro %}\n\n{% if school.gallery_image %}\n<div id=\"schoolHeroCarousel\" class=\"carousel slide mb-8\" data-bs-ride=\"carousel\">\n  <div class=\"carousel-inner\">\n\n    {% for img in school.gallery_image %}\n    {% if img.school_image %}\n    <div class=\"carousel-item {{ 'active' if loop.index == 1 else '' }}\">\n      <div class=\"hero-slide\">\n\n        <!-- Pixelated blurred background -->\n        <div class=\"hero-blur-bg\" style=\"background-image: url('{{ img.resized_small or img.resized_medium or img.school_image }}');\"></div>\n\n        <!-- Dual-layer image wrapper -->\n        <div class=\"hero-img-wrapper\">\n          <!-- Low-res preview -->\n          <img src=\"{{ img.resized_small }}\"\n               class=\"hero-img hero-img-blur\"\n               alt=\"\"\n               aria-hidden=\"true\">\n\n          <!-- Full image with smart fallback -->\n          {{ img_macro.smart_image(\n            img.resized_large,\n            img.resized_medium,\n            img.school_image,\n            img.caption or \"Ifitwala Campus Image\",\n            \"hero-img hero-img-full\"\n          ) }}\n        </div>\n\n        {% if img.caption %}\n        <div class=\"school-caption\">\n          {{ img.caption }}\n        </div>\n        {% endif %}\n\n      </div>\n    </div>\n    {% endif %}\n    {% endfor %}\n\n  </div>\n\n  <!-- Carousel controls -->\n  <button class=\"carousel-control-prev\" type=\"button\" data-bs-target=\"#schoolHeroCarousel\" data-bs-slide=\"prev\">\n    <span class=\"carousel-control-prev-icon\"></span>\n  </button>\n  <button class=\"carousel-control-next\" type=\"button\" data-bs-target=\"#schoolHeroCarousel\" data-bs-slide=\"next\">\n    <span class=\"carousel-control-next-icon\"></span>\n  </button>\n</div>\n{% endif %}\n\n{% if school.school_tagline %}\n<div class=\"school-tagline\">\n  {{ school.school_tagline }}\n</div>\n{% endif %}\n",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-05-04 11:09:37.274448",
  "module": "School Site",
  "name": "home",
  "page_blocks": [],
  "published": 1,
  "route": "home",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "Home",
  "website_sidebar": null
 },
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": "# Helper: Build resized image URL for WebP strategy (slugified inline)\ndef smart_resized_url(original_url, doctype_folder, size_label):\n    if not original_url:\n        return None\n\n    # extract filename without path or extension\n    filename = original_url.split(\"/\")[-1]\n    base = filename.rsplit(\".\", 1)[0]\n\n    # slugify doctype_folder and base: lowercase → alnum else '_' → strip '_' \n    folder_slug = \"\".join(ch if ch.isalnum() else \"_\" for ch in doctype_folder.lower()).strip(\"_\")\n    file_slug   = \"\".join(ch if ch.isalnum() else \"_\" for ch in base.lower()).strip(\"_\")\n\n    return f\"/files/gallery_resized/{folder_slug}/{size_label}_{file_slug}.webp\"\n\n\n# Fetch school\nschool_slug = frappe.form_dict.name\nschool = frappe.get_doc(\"School\", {\"website_slug\": school_slug})\ncontext.school = school\n\n# Process gallery images (carousel)\nfor img in context.school.gallery_image:\n    if img.school_image:\n        img.resized_school_image_card = smart_resized_url(img.school_image, \"school\", \"card\")\n        img.resized_school_image_medium = smart_resized_url(img.school_image, \"school\", \"medium\")\n        img.resized_school_image_hero   = smart_resized_url(img.school_image, \"school\", \"hero\")\n\n# Leadership team (round image cards)\ncontext.leaders = frappe.get_all(\n    \"Employee\",\n    filters={\n        \"school\": school.name,\n        \"department\": \"Academic Leadership\",\n        \"show_on_website\": 1\n    },\n    fields=[\"employee_full_name\", \"employee_image\", \"designation\", \"small_bio\"],\n    order_by=\"modified desc\"\n)\n\nfor leader in context.leaders:\n    if leader.employee_image:\n        leader.resized_employee_image_card = smart_resized_url(leader.employee_image, \"employee\", \"card\")\n\n# Academic staff (carousel)\ncontext.academic_staff = frappe.get_all(\n    \"Employee\",\n    filters={\n        \"school\": school.name,\n        \"show_on_website\": 1,\n        \"department\": [\"!=\", \"Academic Leadership\"]\n    },\n    fields=[\"employee_full_name\", \"employee_image\", \"designation\", \"small_bio\"],\n    order_by=\"modified desc\"\n)\n\nfor person in context.academic_staff:\n    if person.employee_image:\n        person.resized_employee_image_card = smart_resized_url(person.employee_image, \"employee\", \"card\")\n\n# Academic programs (card blocks)\ncontext.programs = frappe.get_all(\n    \"Program\",\n    filters={\n        \"school\": school.name,\n        \"is_published\": 1,\n        \"is_featured\": 1,\n        \"is_group\": 1\n    },\n    fields=[\n        \"name\",\n        \"program_name\",\n        \"program_image\",\n        \"description\"\n    ],\n    order_by=\"is_featured desc, program_name asc\",\n    limit_page_length=6\n)\n\nfor prog in context.programs:\n    prog.resized_program_image_card = smart_resized_url(prog.program_image, \"program\", \"card\")\n    prog.resized_program_image_thumb = smart_resized_url(prog.program_image, \"program\", \"thumb\")\n    prog.description = prog.description or \"\"\n",
  "css": "",
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 1,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 0,
  "javascript": "",
  "main_section": null,
  "main_section_html": "{% import \"ifitwala_ed/templates/includes/smart_image_macro.html\" as img_macro %}\n\n<!-- HEKKKKKOOOOOO Loading -->\n\n{# preload all carousel images #}\n{% for img in school.gallery_image if img.school_image %}\n<link rel=\"preload\" as=\"image\" href=\"{{ img.resized_school_image_card }}\">\n{% endfor %}\n\n<!-- Asset Loading -->\n<script src=\"/assets/ifitwala_ed/dist/website.bundle.js\" defer></script>\n<script src=\"/assets/ifitwala_ed/website/image_fallback.js\" defer></script>\n<script src=\"/assets/ifitwala_ed/dist/school.bundle.js\" defer></script>\n<link rel=\"stylesheet\" href=\"/assets/ifitwala_ed/website/website.css\">\n<link rel=\"stylesheet\" href=\"/assets/ifitwala_ed/website/school.css\">\n\n<!-- Gallery Carousel -->\n{% if school.gallery_image %}\n<div id=\"schoolCarousel\" class=\"carousel slide carousel-fade mb-5\" data-bs-ride=\"carousel\">\n  <div class=\"carousel-inner\">\n    {% for img in school.gallery_image if img.school_image %}\n    <div class=\"carousel-item {{ 'active' if loop.index == 1 else '' }}\">\n      <div class=\"hero-img-wrapper\">\n        {{ img_macro.smart_image(\n        img.resized_school_image_hero,   \n        img.resized_school_image_medium,  \n        img.resized_school_image_card,    \n        img.resized_school_image_thumb,   \n        img.school_image,                 \n        img.caption or \"School Image\",   \n        \"hero-img-full fade-in-real-image\", \n        fallback=\"carousel\"\n        ) }}\n        {% if img.caption %}\n        <div class=\"school-caption bottom-left\">\n          {{ img.caption }}\n        </div>\n        {% endif %}\n      </div>\n    </div>\n    {% endfor %}\n  </div>\n  <button class=\"carousel-control-prev\" type=\"button\" data-bs-target=\"#schoolCarousel\" data-bs-slide=\"prev\">\n    <span class=\"carousel-control-prev-icon\"></span>\n  </button>\n  <button class=\"carousel-control-next\" type=\"button\" data-bs-target=\"#schoolCarousel\" data-bs-slide=\"next\">\n    <span class=\"carousel-control-next-icon\"></span>\n  </button>\n</div>\n{% endif %}\n\n<!-- Educational Philosophy -->\n<h2 class=\"text-center fw-bold display-6 my-5\">Our Educational Philosophy</h2>\n<div class=\"section-divider\"></div>\n<section class=\"container my-5\">\n  <div class=\"row g-4 align-items-stretch\">\n    {% set sections = school.school_philosophy.split('<h2>') %}\n    {% for raw in sections[1:] %}\n    {% set content = raw.split('</h2>') %}\n    <div class=\"col-12 col-md-6 col-lg-4 d-flex\">\n      <div class=\"card h-100 w-100 border-0 shadow-sm philosophy-card fade-in-up\">\n        <div class=\"card-body d-flex flex-column\">\n          <div class=\"text-center mb-3\">\n            <div class=\"icon mb-2\" style=\"font-size: 2rem;\">\n              {% if loop.index == 1 %}🏫{% elif loop.index == 2 %}🌍{% else %}💡{% endif %}\n            </div>\n            <h3 class=\"card-title fw-bold fs-4 mb-1\">{{ content[0] }}</h3>\n            <div class=\"decor-bar mx-auto mb-3\"></div>\n          </div>\n          <div class=\"card-text text-muted flex-grow-1 d-flex flex-column\">\n              <div id=\"philo{{ loop.index }}\" class=\"clamped-text\">\n                {{ content[1] | safe }}\n              </div>\n              <a href=\"#\" \n                 class=\"btn btn-link p-0 mt-auto view-more-link\" \n                 data-target=\"philo{{ loop.index }}\">\n                View more\n              </a>\n            </div>\n        </div>\n      </div>\n    </div>\n    {% endfor %}\n  </div>\n</section>\n\n<!-- Academic Programs -->\n<h2 class=\"text-center fw-bold display-6 my-5\">Academic Programs</h2>\n<div class=\"section-divider\"></div>\n\n{% if programs %}\n<section class=\"container my-5\">\n  <div class=\"program-grid\">\n    {% for p in programs %}\n      <div class=\"program-block\">\n        <a href=\"/academics/program/{{ p.name }}\"\n           class=\"card h-100 w-100 text-decoration-none border-0 shadow-sm {{ 'border-primary border-2' if p.is_featured else '' }}\">\n          {% if p.program_image %}\n            {{ img_macro.smart_image(\n                None,\n                None,\n                p.resized_program_image_card,\n                p.resized_program_image_thumb,\n                p.program_image,\n                p.program_name,\n                \"card-img-top\",\n                fallback=\"card\"\n            ) }}\n          {% endif %}\n          <div class=\"card-body d-flex flex-column\">\n            <h3 class=\"card-title text-center fw-bold fs-5\">{{ p.program_name }}</h3>\n            <div class=\"decor-bar mx-auto mb-2\"></div>\n            <p class=\"card-text text-muted small flex-grow-1\">\n              {{ p.description[:140] }}{% if p.description|length > 140 %}&hellip;{% endif %}\n            </p>\n            <span class=\"mt-2 fw-bold text-primary text-end\">View details &rsaquo;</span>\n          </div>\n        </a>\n      </div>\n    {% endfor %}\n  </div>\n  <div class=\"text-center mt-4\">\n    <a href=\"/files/program_guide.pdf\" class=\"btn btn-primary btn-lg\">\n      Download Program&nbsp;Guide\n    </a>\n  </div>\n</section>\n{% endif %}\n\n<div class=\"section-divider\"></div>\n\n\n<!-- Leadership Section -->\n<h2 class=\"text-center fw-bold display-6 my-5 pd-5\">Leadership Team</h2>\n{% if leaders %}\n<div class=\"leader-grid\">\n  {% for person in leaders %}\n    <div class=\"leader-block\" data-bs-toggle=\"tooltip\" …>\n      {{ img_macro.smart_image(\n        None,\n        person.resized_employee_image_card,\n        person.employee_image,\n        person.employee_full_name,\n        \"lead-circle\",\n        fallback=\"card\"\n      ) }}\n      <div class=\"leader-name\">{{ person.employee_full_name }}</div>\n      <div class=\"leader-role\">{{ person.designation }}</div>\n    </div>\n  {% endfor %}\n</div>\n{% endif %}\n\n\n<!-- Faculty & Staff Carousel -->\n<h2 class=\"text-center fw-bold display-6 my-5\">Faculty &amp; Staff</h2>\n<div class=\"section-divider\"></div>\n\n{% if academic_staff %}\n<div id=\"teamCarousel\" class=\"carousel slide mb-0\" data-bs-ride=\"carousel\">\n  <div class=\"carousel-inner\">\n    {% for i in range(0, academic_staff|length, 2) %}\n      <div class=\"carousel-item {{ 'active' if i == 0 else '' }}\">\n        <div class=\"row gx-4 px-4 justify-content-center\">\n          {% for j in [0, 1] if academic_staff[i + j] %}\n            {% set person = academic_staff[i + j] %}\n            <div class=\"col-12 col-md-6 mb-4\">\n              <div class=\"team-card d-flex\">\n                <div class=\"image-block\">\n                  {{ img_macro.smart_image(\n                      None,\n                      person.resized_employee_image_card,\n                      person.employee_image,\n                      person.employee_full_name,\n                      \"w-100 h-100 rounded object-fit-cover\",\n                      fallback=\"card\"\n                  ) }}\n                </div>\n                <div class=\"text-block\">\n                  <p>{{ person.small_bio }}</p>\n                  <div>\n                    <strong>{{ person.employee_full_name }}</strong>\n                    <span>{{ person.designation }}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          {% endfor %}\n        </div>\n      </div>\n    {% endfor %}\n  </div>\n\n  <div class=\"carousel-indicators\">\n    {% for idx in range((academic_staff|length + 1) // 2) %}\n      <button \n        type=\"button\"\n        data-bs-target=\"#teamCarousel\"\n        data-bs-slide-to=\"{{ idx }}\"\n        class=\"{{ 'active' if idx == 0 else '' }}\"\n        aria-current=\"{{ 'true' if idx == 0 else 'false' }}\"\n        aria-label=\"Slide {{ idx + 1 }}\">\n      </button>\n    {% endfor %}\n  </div>\n\n  <button class=\"carousel-control-prev\" type=\"button\" data-bs-target=\"#teamCarousel\" data-bs-slide=\"prev\">\n    <span class=\"carousel-control-prev-icon\"></span>\n  </button>\n  <button class=\"carousel-control-next\" type=\"button\" data-bs-target=\"#teamCarousel\" data-bs-slide=\"next\">\n    <span class=\"carousel-control-next-icon\"></span>\n  </button>\n</div>\n{% endif %}\n\n<div class=\"section-divider my-4\"></div>\n\n\n<div class=\"text-center mt-4\">\n  <a href=\"/registration-of-interest\" class=\"btn btn-primary btn-lg\">\n    Book a School&nbsp;Visit\n  </a>\n</div>",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-08-26 08:21:00.341130",
  "module": "School Site",
  "name": "school",
  "page_blocks": [],
  "published": 1,
  "route": "academics/program/<name>",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "School",
  "website_sidebar": null
 },
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": null,
  "css": null,
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 1,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 0,
  "javascript": null,
  "main_section": null,
  "main_section_html": null,
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-05-06 07:18:03.084391",
  "module": "School Site",
  "name": "program",
  "page_blocks": [],
  "published": 1,
  "route": "<school>/<name>",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "Program",
  "website_sidebar": null
 }
]
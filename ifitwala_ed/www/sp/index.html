<!-- base_template: ifitwala_ed/templates/sp_base.html -->

{# Page title shown in header + breadcrumbs #}
{% set page_title = _("Dashboard") %}

{# Optional: header actions #}
{% block page_actions %}
	<a class="btn btn-sm btn-outline-secondary" href="{{ portal_root }}/settings">
		<i class="bi bi-gear me-1"></i>{{ _("Settings") }}
	</a>
{% endblock %}

{# Main dashboard content — same sections/IDs so JS can mount later #}
{% block content %}
<section aria-labelledby="tasksLabel" class="mb-4">
	<div class="card shadow-sm">
		<div class="card-body">
			<div class="d-flex align-items-center justify-content-between mb-3">
				<h2 id="tasksLabel" class="h5 mb-0">{{ _("My Tasks Calendar") }}</h2>
				<span class="text-muted small">{{ _("Coming soon") }}</span>
			</div>
			<div id="task-calendar" class="min-vh-25"></div>
		</div>
	</div>
</section>

<section aria-labelledby="scheduleLabel" class="mb-4">
	<div class="card shadow-sm">
		<div class="card-body">
			<div class="d-flex align-items-center justify-content-between mb-3">
				<h2 id="scheduleLabel" class="h5 mb-0">{{ _("Schedule Calendar") }}</h2>
				<span class="text-muted small">{{ _("FullCalendar integration later") }}</span>
			</div>
			<div id="schedule-calendar" class="min-vh-25"></div>
		</div>
	</div>
</section>

<section aria-labelledby="coursesLabel" class="mb-4">
	<div class="d-flex align-items-center justify-content-between mb-2">
		<h2 id="coursesLabel" class="h5 mb-0">My Courses</h2>

		{% if academic_years and academic_years|length %}
			<form method="get" class="d-inline-block">
				<label for="year" class="visually-hidden">Academic Year</label>
				<select name="year" id="year" class="form-select form-select-sm" onchange="this.form.submit()">
					{% for y in academic_years %}
						<option value="{{ y }}"{% if y == selected_year %} selected{% endif %}>{{ y }}</option>
					{% endfor %}
				</select>
			</form>
		{% endif %}
	</div>

	<div id="course-cards" class="row g-3">
		{% if courses and courses|length %}
			{% for c in courses %}
				<div class="col-12 col-sm-6 col-lg-4">
					<div class="card h-100 shadow-sm course-card">
						<div class="ratio ratio-16x9">
							<img
								src="{{ c.course_image }}"
								alt="{{ c.course_name }}"
								class="course-card-img"
								loading="lazy"
								onerror="this.onerror=null; this.src='/assets/ifitwala_ed/images/course_placeholder.png';"
							>
						</div>
						<div class="card-body py-2">
							<div class="course-meta small text-muted">
								{{ c.course_group or '—' }}
							</div>
						</div>
						<a class="stretched-link" href="{{ c.href }}" aria-label="Open {{ c.course_name }}"></a>
					</div>
				</div>
</div>

			{% endfor %}
		{% else %}
			<div class="col-12">
				<div class="alert alert-light border small mb-0">
					{{ courses_empty_reason or "No courses found." }}
				</div>
			</div>
		{% endif %}
	</div>
</section>



<section aria-labelledby="moreLabel" class="mb-4">
	<h2 id="moreLabel" class="h5 mb-2">{{ _("More") }}</h2>
	<div id="extra-cards" class="row g-3">
		<div class="col-12 col-md-6 col-xl-4">
			<div class="card h-100 shadow-sm">
				<div class="card-body d-flex flex-column">
					<div class="d-flex align-items-start justify-content-between mb-2">
						<h3 class="h6 mb-0">{{ _("Student Log") }}</h3>
						<i class="bi bi-clipboard-check"></i>
					</div>
					<p class="text-muted small flex-grow-1 mb-2">{{ _("View your socio-emotional notes and follow-ups.") }}</p>
					<div><a class="btn btn-sm btn-primary" href="{{ portal_root }}/student-log">{{ _("Open") }}</a></div>
				</div>
			</div>
		</div>
		<div class="col-12 col-md-6 col-xl-4">
			<div class="card h-100 shadow-sm">
				<div class="card-body d-flex flex-column">
					<div class="d-flex align-items-start justify-content-between mb-2">
						<h3 class="h6 mb-0">{{ _("Wellbeing") }}</h3>
						<i class="bi bi-heart-pulse"></i>
					</div>
					<p class="text-muted small flex-grow-1 mb-2">{{ _("Resources and check-ins.") }}</p>
					<div><a class="btn btn-sm btn-outline-primary" href="{{ portal_root }}/wellbeing">{{ _("Open") }}</a></div>
				</div>
			</div>
		</div>
		<div class="col-12 col-md-6 col-xl-4">
			<div class="card h-100 shadow-sm">
				<div class="card-body d-flex flex-column">
					<div class="d-flex align-items-start justify-content-between mb-2">
						<h3 class="h6 mb-0">{{ _("Demographics") }}</h3>
						<i class="bi bi-person-vcard"></i>
					</div>
					<p class="text-muted small flex-grow-1 mb-2">{{ _("Your profile and contact details.") }}</p>
					<div><a class="btn btn-sm btn-outline-secondary" href="{{ portal_root }}/profile">{{ _("Manage") }}</a></div>
				</div>
			</div>
		</div>
	</div>
</section>
{% endblock %}
